<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>SHOP CÃ€Y THUÃŠ</title>
<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.box{max-width:420px;margin:auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px #ccc}
.hidden{display:none}
input,button,select{width:100%;padding:10px;margin:8px 0}
button{background:#0066ff;color:#fff;border:none;border-radius:6px;cursor:pointer}
h2{text-align:center}
hr{margin:15px 0}
.log{font-size:14px;border-bottom:1px solid #ddd;padding:5px}
.admin{background:#ffecec;padding:10px;border-radius:8px}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
<h2>ÄÄƒng nháº­p</h2>
<input id="loginUser" placeholder="TÃªn tÃ i khoáº£n">
<input id="loginPass" type="password" placeholder="Máº­t kháº©u">
<button onclick="login()">ÄÄƒng nháº­p</button>
<hr>
<button onclick="showRegister()">Táº¡o tÃ i khoáº£n</button>
</div>

<!-- REGISTER -->
<div class="box hidden" id="registerBox">
<h2>ÄÄƒng kÃ½</h2>
<input id="regUser" placeholder="TÃªn tÃ i khoáº£n">
<input id="regPass" type="password" placeholder="Máº­t kháº©u">
<button onclick="register()">ÄÄƒng kÃ½</button>
<hr>
<button onclick="showLogin()">Quay láº¡i Ä‘Äƒng nháº­p</button>
</div>

<!-- SHOP -->
<div class="box hidden" id="shopBox">
<h2>SHOP CÃ€Y THUÃŠ</h2>
<p>ğŸ‘¤ Xin chÃ o: <b id="userName"></b></p>
<p>ğŸ’° Sá»‘ dÆ°: <b id="balance">0</b>Ä‘</p>

<select id="service">
<option value="50000">CÃ y 500 LV - 50.000Ä‘</option>
<option value="100000">CÃ y 1000 LV - 100.000Ä‘</option>
<option value="200000">LÃªn V4 - 200.000Ä‘</option>
</select>

<input id="coupon" placeholder="MÃ£ giáº£m giÃ¡ (SALE10)">
<button onclick="buy()">Mua dá»‹ch vá»¥</button>

<hr>
<h3>Náº¡p card (demo)</h3>
<input id="napTien" type="number" placeholder="Sá»‘ tiá»n náº¡p">
<button onclick="nap()">Náº¡p tiá»n</button>

<hr>
<h3>Lá»‹ch sá»­</h3>
<div id="history"></div>

<button onclick="logout()">ÄÄƒng xuáº¥t</button>

<!-- ADMIN -->
<div id="adminBox" class="admin hidden">
<h3>ADMIN</h3>
<input id="adminUser" placeholder="User cáº§n chá»‰nh">
<input id="adminMoney" type="number" placeholder="Sá»‘ tiá»n">
<button onclick="setMoney()">Cá»™ng tiá»n</button>
</div>

</div>

<script>
let currentUser = localStorage.getItem("currentUser");

// COUPON
const coupons = {
  "SALE10":10,
  "SALE20":20
};

// LOAD
if(currentUser) loadShop();

function saveUser(u,data){
  localStorage.setItem("user_"+u,JSON.stringify(data));
}

function getUser(u){
  return JSON.parse(localStorage.getItem("user_"+u));
}

function showRegister(){
  loginBox.classList.add("hidden");
  registerBox.classList.remove("hidden");
}

function showLogin(){
  registerBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
}

function register(){
  let u=regUser.value.trim();
  let p=regPass.value.trim();
  if(!u||!p) return alert("Nháº­p Ä‘á»§");
  if(getUser(u)) return alert("TÃ i khoáº£n tá»“n táº¡i");
  saveUser(u,{pass:p,balance:0,log:[]});
  alert("ÄÄƒng kÃ½ thÃ nh cÃ´ng");
  showLogin();
}

function login(){
  let u=loginUser.value.trim();
  let p=loginPass.value.trim();
  let data=getUser(u);
  if(!data||data.pass!==p) return alert("Sai tÃ i khoáº£n");
  localStorage.setItem("currentUser",u);
  loadShop();
}

function loadShop(){
  loginBox.classList.add("hidden");
  registerBox.classList.add("hidden");
  shopBox.classList.remove("hidden");
  currentUser=localStorage.getItem("currentUser");
  userName.innerText=currentUser;
  render();
  if(currentUser==="admin") adminBox.classList.remove("hidden");
}

function render(){
  let u=getUser(currentUser);
  balance.innerText=u.balance;
  history.innerHTML="";
  u.log.forEach(l=>{
    let d=document.createElement("div");
    d.className="log";
    d.innerText=l;
    history.prepend(d);
  });
}

function nap(){
  let t=Number(napTien.value);
  if(t<=0) return;
  let u=getUser(currentUser);
  u.balance+=t;
  u.log.push("Náº¡p +"+t+"Ä‘");
  saveUser(currentUser,u);
  render();
}

function buy(){
  let price=Number(service.value);
  let code=coupon.value.trim();
  let discount= coupons[code]?price*coupons[code]/100:0;
  let pay=price-discount;
  let u=getUser(currentUser);
  if(u.balance<pay) return alert("KhÃ´ng Ä‘á»§ tiá»n");
  u.balance-=pay;
  u.log.push("Mua dá»‹ch vá»¥ -"+pay+"Ä‘");
  saveUser(currentUser,u);
  render();
}

function logout(){
  localStorage.removeItem("currentUser");
  location.reload();
}

// ADMIN
function setMoney(){
  let u=adminUser.value.trim();
  let m=Number(adminMoney.value);
  let data=getUser(u);
  if(!data) return alert("User khÃ´ng tá»“n táº¡i");
  data.balance+=m;
  data.log.push("Admin cá»™ng "+m+"Ä‘");
  saveUser(u,data);
  alert("ÄÃ£ cá»™ng tiá»n");
}
</script>

</body>
</html>
